!function(a){var b={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?void 0:!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?!1:void 0}),!!d):d},mixin:a.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var h,i,f=this,g=arguments;return h=function(){d=null,c||(e=a.apply(f,g))},i=c&&!d,clearTimeout(d),d=setTimeout(h,b),i&&(e=a.apply(f,g)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},noop:function(){}},c="0.10.0",d=function(){function d(a){this.maxSize=a||100,this.size=0,this.hash={},this.list=new e}function e(){this.head=this.tail=null}function f(a,b){this.key=a,this.val=b,this.prev=this.next=null}return b.mixin(d.prototype,{set:function(a,b){var d,c=this.list.tail;this.size>=this.maxSize&&(this.list.remove(c),delete this.hash[c.key]),(d=this.hash[a])?(d.val=b,this.list.moveToFront(d)):(d=new f(a,b),this.list.add(d),this.hash[a]=d,this.size++)},get:function(a){var b=this.hash[a];return b?(this.list.moveToFront(b),b.val):void 0}}),b.mixin(e.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),d}(this),e=function(){function e(a){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function f(){return(new Date).getTime()}function g(a){return JSON.stringify(b.isUndefined(a)?null:a)}function h(a){return JSON.parse(a)}var a,c;try{a=window.localStorage,a.setItem("~~~","!"),a.removeItem("~~~")}catch(d){a=null}return c=a&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(b){return this.isExpired(b)&&this.remove(b),h(a.getItem(this._prefix(b)))},set:function(c,d,e){return b.isNumber(e)?a.setItem(this._ttlKey(c),g(f()+e)):a.removeItem(this._ttlKey(c)),a.setItem(this._prefix(c),g(d))},remove:function(b){return a.removeItem(this._ttlKey(b)),a.removeItem(this._prefix(b)),this},clear:function(){var b,c,d=[],e=a.length;for(b=0;e>b;b++)(c=a.key(b)).match(this.keyMatcher)&&d.push(c.replace(this.keyMatcher,""));for(b=d.length;b--;)this.remove(d[b]);return this},isExpired:function(c){var d=h(a.getItem(this._ttlKey(c)));return b.isNumber(d)&&f()>d?!0:!1}}:{get:b.noop,set:b.noop,remove:b.noop,clear:b.noop,isExpired:b.noop},b.mixin(e.prototype,c),e}(),f=function(){function h(b){b=b||{},this._send=b.send?i(b.send):a.ajax,this._get=b.rateLimiter?b.rateLimiter(this._get):this._get}function i(c){return function(d,e){function g(a){b.defer(function(){f.resolve(a)})}function h(a){b.defer(function(){f.reject(a)})}var f=a.Deferred();return c(d,e,g,h),f}}var c=0,e={},f=6,g=new d(10);return h.setMaxPendingRequests=function(a){f=a},h.resetCache=function(){g=new d(10)},b.mixin(h.prototype,{_get:function(a,b,d){function j(b){d&&d(b),g.set(a,b)}function k(){c--,delete e[a],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var i,h=this;(i=e[a])?i.done(j):f>c?(c++,e[a]=this._send(a,b).done(j).always(k)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(a,c,d){var f;return b.isFunction(c)&&(d=c,c={}),(f=g.get(a))?b.defer(function(){d&&d(f)}):this._get(a,c,d),!!f}}),h}(),g=function(){function c(b){b=b||{},b.datumTokenizer&&b.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=b.datumTokenizer,this.queryTokenizer=b.queryTokenizer,this.datums=[],this.trie=e()}function d(a){return a=b.filter(a,function(a){return!!a}),a=b.map(a,function(a){return a.toLowerCase()})}function e(){return{ids:[],children:{}}}function f(a){for(var b={},c=[],d=0;d<a.length;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function g(a,b){function f(a,b){return a-b}var c=0,d=0,e=[];for(a=a.sort(f),b=b.sort(f);c<a.length&&d<b.length;)a[c]<b[d]?c++:a[c]>b[d]?d++:(e.push(a[c]),c++,d++);return e}return b.mixin(c.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(a){var c=this;a=b.isArray(a)?a:[a],b.each(a,function(a){var f,g;f=c.datums.push(a)-1,g=d(c.datumTokenizer(a)),b.each(g,function(a){var b,d,g;for(b=c.trie,d=a.split("");g=d.shift();)b=b.children[g]||(b.children[g]=e()),b.ids.push(f)})})},get:function(a){var e,h,c=this;return e=d(this.queryTokenizer(a)),b.each(e,function(a){var b,d,e,f;if(h&&0===h.length)return!1;for(b=c.trie,d=a.split("");b&&(e=d.shift());)b=b.children[e];return b&&0===d.length?(f=b.ids.slice(0),h=h?g(h,f):f,void 0):(h=[],!1)}),h?b.map(f(h),function(a){return c.datums[a]}):[]},serialize:function(){return{datums:this.datums,trie:this.trie}}}),c}(),h=function(){function d(a){return a.local||null}function e(d){var e,f;return f={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(e=d.prefetch||null)&&(e=b.isString(e)?{url:e}:e,e=b.mixin(f,e),e.thumbprint=c+e.thumbprint,e.ajax.method=e.ajax.method||"get",e.ajax.dataType=e.ajax.dataType||"json",!e.url&&a.error("prefetch requires url to be set")),e}function f(c){function f(a){return function(c){return b.debounce(c,a)}}function g(a){return function(c){return b.throttle(c,a)}}var d,e;return e={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(d=c.remote||null)&&(d=b.isString(d)?{url:d}:d,d=b.mixin(e,d),d.rateLimiter=/^throttle$/i.test(d.rateLimitBy)?g(d.rateLimitWait):f(d.rateLimitWait),d.ajax.method=d.ajax.method||"get",d.ajax.dataType=d.ajax.dataType||"json",delete d.rateLimitBy,delete d.rateLimitWait,!d.url&&a.error("remote requires url to be set")),d}return{local:d,prefetch:e,remote:f}}();window.Bloodhound=function(){function d(b){b&&(b.local||b.prefetch||b.remote)||a.error("one of local, prefetch, or remote is required"),this.limit=b.limit||5,this.sorter=b.sorter||i,this.dupDetector=b.dupDetector||j,this.local=h.local(b),this.prefetch=h.prefetch(b),this.remote=h.remote(b),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new g({datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer}),this.storage=this.cacheKey?new e(this.cacheKey):null}function i(){return 0}function j(){return!1}var c;return c={data:"data",protocol:"protocol",thumbprint:"thumbprint"},d.tokenizers={whitespace:function(a){return a.split(/\s+/)},nonword:function(a){return a.split(/\W+/)}},b.mixin(d.prototype,{_loadPrefetch:function(b){function f(a){var d;d=b.filter?b.filter(a):a,c.add(d),c._saveToStorage(c.index.serialize(),b.thumbprint,b.ttl)}var d,e,c=this;return(d=this._readFromStorage(b.thumbprint))?(this.index.bootstrap(d),e=a.Deferred().resolve()):e=a.ajax(b.url,b.ajax).done(f),e},_getFromRemote:function(a,b){function f(a){var d=c.remote.filter?c.remote.filter(a):a;b(d)}var d,e,c=this;return a=a||"",e=encodeURIComponent(a),d=this.remote.replace?this.remote.replace(this.remote.url,a):this.remote.url.replace(this.remote.wildcard,e),this.transport.get(d,this.remote.ajax,f)},_saveToStorage:function(a,b,d){this.storage&&(this.storage.set(c.data,a,d),this.storage.set(c.protocol,location.protocol,d),this.storage.set(c.thumbprint,b,d))},_readFromStorage:function(a){var b={};return this.storage&&(b.data=this.storage.get(c.data),b.protocol=this.storage.get(c.protocol),b.thumbprint=this.storage.get(c.thumbprint)),isExpired=b.thumbprint!==a||b.protocol!==location.protocol,b.data&&!isExpired?b.data:null},initialize:function(){function d(){b.add(b.local)}var c,b=this;return c=this.prefetch?this._loadPrefetch(this.prefetch):a.Deferred().resolve(),this.local&&c.done(d),this.transport=this.remote?new f(this.remote):null,this.initialize=function(){return c.promise()},c.promise()},add:function(a){this.index.add(a)},get:function(a,c){function g(a){var f=e.slice(0);b.each(a,function(a){var c;return c=b.some(f,function(b){return d.dupDetector(a,b)}),!c&&f.push(a),f.length<d.limit}),c&&c(f.sort(d.sorter))}var e,d=this,f=!1;e=this.index.get(a).sort(this.sorter).slice(0,this.limit),e.length<this.limit&&this.transport&&(f=this._getFromRemote(a,g)),!f&&c&&c(e)},ttAdapter:function(){return b.bind(this.get,this)}}),d}();var j={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion">%BODY%</div>'},k={wrapper:{position:"relative",display:"block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};b.isMsie()&&b.mixin(k.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),b.isMsie()&&b.isMsie()<=7&&b.mixin(k.input,{marginTop:"-1px"});var l=function(){function d(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}var c="typeahead:";return b.mixin(d.prototype,{trigger:function(a){var b=[].slice.call(arguments,1);this.$el.trigger(c+a,b)}}),d}(),m=function(){function c(b,c,d,e){var f;if(!d)return this;for(c=c.split(a),d=e?j(d,e):d,this._callbacks=this._callbacks||{};f=c.shift();)this._callbacks[f]=this._callbacks[f]||{sync:[],async:[]},this._callbacks[f][b].push(d);return this}function d(a,b,d){return c.call(this,"async",a,b,d)}function e(a,b,d){return c.call(this,"sync",a,b,d)}function f(b){var c;if(!this._callbacks)return this;for(b=b.split(a);c=b.shift();)delete this._callbacks[c];return this}function g(c){var e,f,g,i,j;if(!this._callbacks)return this;for(c=c.split(a),g=[].slice.call(arguments,1);(e=c.shift())&&(f=this._callbacks[e]);)i=h(f.sync,this,[e].concat(g)),j=h(f.async,this,[e].concat(g)),i()&&b(j);return this}function h(a,b,c){function d(){for(var d,e=0;!d&&e<a.length;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function i(){var a;return a=window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function j(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var a=/\s+/,b=i();return{onSync:e,onAsync:d,off:f,trigger:g}}(),n=function(a){function d(a,c,d){for(var f,e=[],g=0;g<a.length;g++)e.push(b.escapeRegExChars(a[g]));return f=d?"\\b("+e.join("|")+")\\b":"("+e.join("|")+")",c?new RegExp(f):new RegExp(f,"i")}var c={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(e){function g(b){var c,d;return(c=f.exec(b.data))&&(wrapperNode=a.createElement(e.tagName),e.className&&(wrapperNode.className=e.className),d=b.splitText(c.index),d.splitText(c[0].length),wrapperNode.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(wrapperNode,d)),!!c}function h(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:h(c,b)}var f;e=b.mixin({},c,e),e.node&&e.pattern&&(e.pattern=b.isArray(e.pattern)?e.pattern:[e.pattern],f=d(e.pattern,e.caseSensitive,e.wordsOnly),h(e.node,g))}}(window.document),o=function(){function d(d){var g,h,i,j,f=this;d=d||{},d.input||a.error("input is missing"),g=b.bind(this._onBlur,this),h=b.bind(this._onFocus,this),i=b.bind(this._onKeydown,this),j=b.bind(this._onInput,this),this.$hint=a(d.hint),this.$input=a(d.input).on("blur.tt",g).on("focus.tt",h).on("keydown.tt",i),0===this.$hint.length&&(this.setHintValue=this.getHintValue=this.clearHint=b.noop),b.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){c[a.which||a.keyCode]||b.defer(b.bind(f._onInput,f,a))}):this.$input.on("input.tt",j),this.query=this.$input.val(),this.$overflowHelper=e(this.$input)}function e(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"nowrap",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function f(a,b){return d.normalizeQuery(a)===d.normalizeQuery(b)}function g(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var c;return c={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},d.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(d.prototype,m,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=c[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,b){var c,d,e;switch(a){case"tab":d=this.getHintValue(),e=this.getInputValue(),c=d&&d!==e&&!g(b);break;case"up":case"down":c=!g(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!g(b);break;default:c=!0}return c},_checkInputValue:function(){var a,b,c;a=this.getInputValue(),b=f(a,this.query),c=b?this.query.length!==a.length:!1,b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=a)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){this.$input.val(a),!b&&this._checkInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(a){this.$hint.val(a)},resetInputValue:function(){this.$input.val(this.query)},clearHint:function(){this.$hint.val("")},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:document.selection?(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),d}(),p=function(){function f(c){c=c||{},c.templates=c.templates||{},c.source||a.error("missing source"),this.query=null,this.highlight=!!c.highlight,this.name=c.name||b.getUniqueId(),this.source=c.source,this.valueKey=c.displayKey||"value",this.templates=g(c.templates,this.valueKey),this.$el=a(j.dataset.replace("%CLASS%",this.name))}function g(a,c){function d(a){return"<p>"+a[c]+"</p>"}return{empty:a.empty&&b.templatify(a.empty),header:a.header&&b.templatify(a.header),footer:a.footer&&b.templatify(a.footer),suggestion:a.suggestion||d}}var c="ttDataset",d="ttValue",e="ttDatum";return f.extractDatasetName=function(b){return a(b).data(c)},f.extractValue=function(b){return a(b).data(d)},f.extractDatum=function(b){return a(b).data(e)},b.mixin(f.prototype,m,{_render:function(f,g){function l(){return h.templates.empty({query:f})}function m(){function l(b){var f,g,i;return g=h.templates.suggestion(b),i=j.suggestion.replace("%BODY%",g),f=a(i).data(c,h.name).data(d,b[h.valueKey]).data(e,b),f.children().each(function(){a(this).css(k.suggestionChild)}),f}var i;return i=a(j.suggestions).css(k.suggestions).append(b.map(g,l)),h.highlight&&n({node:i[0],pattern:f}),i}function o(){return h.templates.header({query:f,isEmpty:!i})}function p(){return h.templates.footer({query:f,isEmpty:!i})}if(this.$el){var i,h=this;this.$el.empty(),i=g&&g.length,!i&&this.templates.empty?this.$el.html(l()).prepend(h.templates.header?o():null).append(h.templates.footer?p():null):i&&this.$el.html(m()).prepend(h.templates.header?o():null).append(h.templates.footer?p():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){function c(c){a===b.query&&b._render(a,c)}var b=this;this.query=a,this.source(a,c)},clear:function(){this._render(this.query||"")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),f}(),q=function(){function c(c){var f,g,h,i,j,e=this;c=c||{},c.menu||a.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.isMouseOverDropdown=!1,this.datasets=b.map(c.datasets,d),f=b.bind(this._onMouseEnter,this),g=b.bind(this._onMouseLeave,this),h=b.bind(this._onSuggestionClick,this),i=b.bind(this._onSuggestionMouseEnter,this),j=b.bind(this._onSuggestionMouseLeave,this),this.$menu=a(c.menu).on("mouseenter.tt",f).on("mouseleave.tt",g).on("click.tt",".tt-suggestion",h).on("mouseenter.tt",".tt-suggestion",i).on("mouseleave.tt",".tt-suggestion",j),b.each(this.datasets,function(a){e.$menu.append(a.getRoot()),a.onSync("rendered",e._onRendered,e)})}function d(a){return new p(a)}return b.mixin(c.prototype,m,{_onMouseEnter:function(){this.isMouseOverDropdown=!0},_onMouseLeave:function(){this.isMouseOverDropdown=!1},_onSuggestionClick:function(b){this.trigger("suggestionClicked",a(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor(),this._setCursor(a(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function a(a){return a.isEmpty()}this.isEmpty=b.every(this.datasets,a),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(a,b){a.first().addClass("tt-cursor"),!b&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(a){var b,c,d,e;if(this.isOpen){if(c=this._getCursor(),b=this._getSuggestions(),this._removeCursor(),d=b.index(c)+a,d=(d+1)%(b.length+1)-1,-1===d)return this.trigger("cursorRemoved"),void 0;-1>d&&(d=b.length-1),this._setCursor(e=b.eq(d)),this._ensureVisible(e)}},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$menu.scrollTop(),e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>b?this.$menu.scrollTop(d+b):c>e&&this.$menu.scrollTop(d+(c-e))},close:function(){this.isOpen&&(this.isOpen=this.isMouseOverDropdown=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?k.ltr:k.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var b=null;return a.length&&(b={raw:p.extractDatum(a),value:p.extractValue(a),datasetName:p.extractDatasetName(a)}),b},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(a){function c(b){b.update(a)}b.each(this.datasets,c)},empty:function(){function a(a){a.clear()}b.each(this.datasets,a)},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function a(a){a.destroy()}this.$menu.off(".tt"),this.$menu=null,b.each(this.datasets,a)}}),c}(),r=function(){function d(c){var d,f,g;c=c||{},c.input||a.error("missing input"),this.autoselect=!!c.autoselect,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.$node=e(c.input,c.withHint),d=this.$node.find(".tt-dropdown-menu"),f=this.$node.find(".tt-input"),g=this.$node.find(".tt-hint"),this.eventBus=c.eventBus||new l({el:f}),this.dropdown=new q({menu:d,datasets:c.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new o({input:f,hint:g}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),d.on("mousedown.tt",function(a){b.isMsie()&&b.isMsie()<9&&(f[0].onbeforedeactivate=function(){window.event.returnValue=!1,f[0].onbeforedeactivate=null}),a.preventDefault()})}function e(b,d){var e,g,h,i;e=a(b),g=a(j.wrapper).css(k.wrapper),h=a(j.dropdown).css(k.dropdown),i=e.clone().css(k.hint).css(f(e)),i.removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),e.data(c,{dir:e.attr("dir"),autocomplete:e.attr("autocomplete"),spellcheck:e.attr("spellcheck"),style:e.attr("style")}),e.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(d?k.input:k.inputWithNoHint);try{!e.attr("dir")&&e.attr("dir","auto")}catch(l){}return e.wrap(g).parent().prepend(d?i:null).append(h)}function f(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function g(a){var d=a.find(".tt-input");b.each(d.data(c),function(a,c){b.isUndefined(a)?d.removeAttr(c):d.attr(c,a)}),d.detach().removeData(c).removeClass("tt-input").insertAfter(a),a.remove()}var c="ttAttrs";return b.mixin(d.prototype,{_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();this.input.clearHint(),this.input.setInputValue(a.value,!0),this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.dropdown.open()},_onBlurred:function(){!this.dropdown.isMouseOverDropdown&&this.dropdown.close()},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor(),d=this.dropdown.getDatumForTopSuggestion(),c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete()},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();!this.dropdown.isOpen&&a.length>=this.minLength&&this.dropdown.update(a),this.dropdown.open(),this.dropdown.moveCursorUp()},_onDownKeyed:function(){var a=this.input.getQuery();!this.dropdown.isOpen&&a.length>=this.minLength&&this.dropdown.update(a),this.dropdown.open(),this.dropdown.moveCursorDown()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHint(),this.dropdown.empty(),b.length>=this.minLength&&this.dropdown.update(b),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var a;this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,c,d,e,f,g;a=this.dropdown.getDatumForTopSuggestion(),a&&this.dropdown.isVisible()&&!this.input.hasOverflow()&&(c=this.input.getInputValue(),d=o.normalizeQuery(c),e=b.escapeRegExChars(d),f=new RegExp("^(?:"+e+")(.*$)","i"),g=f.exec(a.value),this.input.setHintValue(c+(g?g[1]:"")))},_autocomplete:function(){var a,b,c;a=this.input.getHintValue(),b=this.input.getQuery(),a&&b!==a&&this.input.isCursorAtEnd()&&(c=this.dropdown.getDatumForTopSuggestion(),c&&this.input.setInputValue(c.value),this.eventBus.trigger("autocompleted",c.raw,c.datasetName))},_select:function(a){this.input.clearHint(),this.input.setQuery(a.value),this.input.setInputValue(a.value,!0),this.dropdown.empty(),this._setLanguageDirection(),b.defer(b.bind(this.dropdown.close,this.dropdown)),this.eventBus.trigger("selected",a.raw,a.datasetName)},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},getQuery:function(){return this.input.getQuery()},setQuery:function(a){this.input.setInputValue(a)},destroy:function(){this.input.destroy(),this.dropdown.destroy(),g(this.$node),this.$node=null}}),d}();!function(){var c,d;c="ttTypeahead",d={initialize:function(d){function f(){var g,h,f=a(this);b.each(e,function(a){a.highlight=!!d.highlight}),h=new r({input:f,eventBus:g=new l({el:f}),withHint:b.isUndefined(d.hint)?!0:!!d.hint,minLength:d.minLength,autoselect:d.autoselect,datasets:e}),f.data(c,h)}var e=[].slice.call(arguments,1);return d=d||{},this.each(f)},open:function(){function b(){var d,b=a(this);(d=b.data(c))&&d.open()}return this.each(b)},close:function(){function b(){var d,b=a(this);(d=b.data(c))&&d.close()}return this.each(b)},val:function(d){function e(){var e,b=a(this);(e=b.data(c))&&e.setQuery(d)}function f(){var d,e,b=a(this);return(d=b.data(c))&&(e=d.getQuery()),e}return b.isString(d)?this.each(e):this.map(f).get()},destroy:function(){function b(){var d,b=a(this);(d=b.data(c))&&(d.destroy(),b.removeData(c))}return this.each(b)}},jQuery.fn.typeahead=function(a){return d[a]?d[a].apply(this,[].slice.call(arguments,1)):d.initialize.apply(this,arguments)}}()}(window.jQuery);